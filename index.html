<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LBV Predictor</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6 font-sans">

  <div class="max-w-6xl mx-auto bg-white p-8 rounded-2xl shadow-lg">
    <h2 class="text-3xl font-bold text-blue-800 mb-6">Predict Laminar Burning Velocity</h2>

    <!-- Input Form -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <input id="temp" placeholder="Temperature (K)" class="w-full px-4 py-2 border rounded-lg" type="number">
        <input id="pressure" placeholder="Pressure (atm)" class="w-full mt-4 px-4 py-2 border rounded-lg" type="number">
        <input id="phi" placeholder="Equivalence Ratio" class="w-full mt-4 px-4 py-2 border rounded-lg" type="number">
        <select id="fuel" class="w-full mt-4 px-4 py-2 border rounded-lg">
          <option value="">Select Fuel Type</option>
          <option>PB-Amonia 0.3</option>
          <option>NH3/H2+Air 0.3</option>
          <option>iso-Octane</option>
          <!-- Add more fuel types -->
        </select>

        <!-- Buttons -->
        <div class="flex gap-4 mt-4">
          <button onclick="predictLBV()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-xl">Predict</button>
          <button onclick="clearForm()" class="bg-gray-300 hover:bg-gray-400 px-6 py-2 rounded-xl">Clear</button>
        </div>

        <!-- Prediction Output -->
        <div id="result" class="mt-4 bg-blue-50 text-blue-900 p-4 rounded-lg hidden">
          Predicted LBV: <span id="lbvValue" class="font-bold"></span> cm/s
        </div>
      </div>

      <!-- Right Panel -->
      <div>
        <div class="bg-gray-100 p-4 rounded-xl h-40 overflow-y-auto mb-4">
          <h4 class="font-semibold text-gray-700 mb-2">Prediction History</h4>
          <ul id="historyList" class="text-sm text-gray-800"></ul>
        </div>

        <div class="bg-gray-100 p-4 rounded-xl h-32 overflow-y-auto">
          <h4 class="font-semibold text-gray-700 mb-2">Saved Predictions</h4>
          <ul id="savedList" class="text-sm text-gray-800"></ul>
        </div>

        <div class="flex gap-4 mt-4">
          <button onclick="savePrediction()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg">Save</button>
          <button onclick="downloadExcel()" class="bg-yellow-400 hover:bg-yellow-500 px-4 py-2 rounded-lg">Download Excel</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    async function predictLBV() {
      const T = document.getElementById('temp').value;
      const P = document.getElementById('pressure').value;
      const Phi = document.getElementById('phi').value;
      const fuel = document.getElementById('fuel').value;

      if (!T || !P || !Phi || !fuel) {
        alert("Please fill in all fields");
        return;
      }

      const payload = { temperature: T, pressure: P, equivalenceRatio: Phi, fuelType: fuel };

      try {
        const response = await fetch('https://lbvpredictor-backendsujal-2.onrender.com/api/predict', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
        });

        const result = await response.json();
        const lbv = parseFloat(result.lbv).toFixed(2);
        document.getElementById('lbvValue').innerText = lbv;
        document.getElementById('result').classList.remove('hidden');

        const historyEntry = `${fuel} | T=${T}, P=${P}, Phi=${Phi} â†’ LBV=${lbv}`;
        const li = document.createElement('li');
        li.textContent = historyEntry;
        document.getElementById('historyList').appendChild(li);
      } catch (error) {
        alert("Prediction failed. Please check your internet or backend.");
        console.error(error);
      }
    }

    function clearForm() {
      document.getElementById('temp').value = '';
      document.getElementById('pressure').value = '';
      document.getElementById('phi').value = '';
      document.getElementById('fuel').value = '';
      document.getElementById('result').classList.add('hidden');
    }

    function savePrediction() {
      const val = document.getElementById('lbvValue').innerText;
      if (!val) return;
      const li = document.createElement('li');
      li.textContent = `Saved LBV: ${val} cm/s`;
      document.getElementById('savedList').appendChild(li);
    }

    function downloadExcel() {
      alert("Excel download functionality not yet implemented.");
    }
  </script>
</body>
</html>

